WITH RECURSIVE RevenueDecline AS (
    --  Step 1: Select the most recent year from the financials table as the starting point 
    SELECT 
        year,
        revenue, 
        operating_income, 
        revenue - operating_income AS profit
    FROM 
        financials
    WHERE 
        year = (SELECT MAX(year) FROM financials)

    UNION ALL

    -- Step 2: Recursively calculate the next yearâ€™s revenue, operating income, and profit
    SELECT 
        year + 1,
        revenue * 0.8,  -- decrease revenue by 20% each year
        operating_income,
        revenue * 0.8 - operating_income AS profit
    FROM 
        RevenueDecline
    WHERE 
        profit >= 0  -- continue recursion until profit becomes negative
)

-- Step 3: Combine data from the original table with the recursive CTE
SELECT 
    year, 
    revenue - operating_income AS profit
FROM 
    financials

UNION

-- Step 4: Add the future years generated by the CTE
SELECT 
    year, 
    profit
FROM 
    RevenueDecline

ORDER BY 
    year ASC;
